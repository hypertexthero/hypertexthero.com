# Usage:

# =Start nginx:
# /usr/local/sbin/nginx -p /users/home/sgriffee/ -c /users/home/sgriffee/domains/hypertexthero.com/etc/nginx/sites-enabled/nginx.conf

# =Stop nginx:
# ps aux
# see process number
# kill process number (may need to do it a few times.)

# =Todo: fabric script to automate this

# http://stackoverflow.com/questions/13371925/how-to-turn-off-or-specify-the-nginx-error-log-location
error_log /dev/null crit;

worker_processes 1;
pid /users/home/sgriffee/domains/hypertexthero.com/tmp/nginx.pid;

events { 
    worker_connections  24; 
} 

http { 
    include     /opt/local/etc/nginx/mime.types; 
    
    client_body_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/client_temp 1 2;
    proxy_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/proxy_temp 1 2;
    fastcgi_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/fstcgi_temp 1 2; 
    uwsgi_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/uwsgi_temp 1 2; 
    scgi_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/scgi_temp 1 2; 
    
    log_format main '$remote_addr - $remote_user [$time_local] '
                  '"$request" $status  $body_bytes_sent "$http_referer" '
                  '"$http_user_agent" "$http_x_forwarded_for"';
                  
    access_log /users/home/sgriffee/domains/hypertexthero.com/logs/nginx/nginx.access.log;
    error_log /users/home/sgriffee/domains/hypertexthero.com/logs/nginx/nginx.error.log;
    
    server { 
        listen       11180; 
        server_name  hypertexthero.com; 
        # error_log /users/home/sgriffee/domains/hypertexthero.com/logs/nginx-fcgi.error.log;
        
        location /static/files  {
            alias /users/home/sgriffee/domains/hypertexthero.com/web/public/static/files;
        }
        
        location /static {
            alias /users/home/sgriffee/domains/hypertexthero.com/web/public/static;
        }
        
        location /typography {
            alias /users/home/sgriffee/domains/hypertexthero.com/web/public/typography;
        }
        
        location /ippc {
            alias /users/home/sgriffee/domains/hypertexthero.com/web/public/ippc;
        }
        
        location / { 
            fastcgi_pass unix:/users/home/sgriffee/domains/hypertexthero.com/web/hth/hth.socket; 
            
            # fastcgi parameters 
            fastcgi_param PATH_INFO $fastcgi_script_name; 
            fastcgi_param QUERY_STRING $query_string; 
            fastcgi_param REQUEST_METHOD $request_method; 
            fastcgi_param SERVER_PORT $server_port; 
            fastcgi_param SERVER_PROTOCOL $server_protocol; 
            fastcgi_param SERVER_NAME $server_name; 
            fastcgi_param CONTENT_TYPE $content_type; 
            fastcgi_param CONTENT_LENGTH $content_length; 
        }    
    }   
}


# 
# worker_processes 1;
# pid /users/home/sgriffee/domains/hypertexthero.com/tmp/nginx.pid;
# 
# events {
#     worker_connections 1024;
# }
#  
# http {
#     sendfile on;
#     tcp_nopush on;
#     tcp_nodelay off;
#     default_type application/octet-stream;
#     
#     client_body_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/client_temp 1 2;
#     proxy_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/proxy_temp 1 2;
#     fastcgi_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/fstcgi_temp 1 2; 
#     uwsgi_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/uwsgi_temp 1 2; 
#     scgi_temp_path /users/home/sgriffee/domains/hypertexthero.com/var/spool/nginx/scgi_temp 1 2; 
#     
#     log_format main '$remote_addr - $remote_user [$time_local] '
#                   '"$request" $status  $body_bytes_sent "$http_referer" '
#                   '"$http_user_agent" "$http_x_forwarded_for"';
#                   
#     access_log /users/home/sgriffee/domains/hypertexthero.com/logs/nginx/nginx.access.log;
#     error_log /users/home/sgriffee/domains/hypertexthero.com/logs/nginx/nginx.error.log;
#   
#     upstream backend  {
#         server unix:///users/home/sgriffee/domains/hypertexthero.com/var/run/uwsgi/hth.sock;
#     }
#     
#     server {
#         listen 11180;
#         server_name 127.0.0.1;
#         charset utf-8;
#         client_max_body_size 75M;
#     
#         location /media  {
#                     alias /users/home/sgriffee/domains/hypertexthero.com/web/hth/media;
#         }
#         
#         location /static {
#                 alias /users/home/sgriffee/domains/hypertexthero.com/web/hth/static;
#         }
#     
#         location /  {
#             include uwsgi_params;
#             uwsgi_pass backend;
#         }
#     }
# }
